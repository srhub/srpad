window.onload = function() {
	var width = 768;
	var height = 1024/2;
    var paper = Raphael("canvas", width, height);

	// draw attacker
	drawAvatar(paper, {x: 20, y: 60, name: "Aquila", path: "resources/avatars/avatar2.jpg"});
	
	// draw target
	drawAvatar(paper, {x: 600, y: 60, name: "NPC", path: "resources/avatars/avatar3.jpg"});
	
	// draw properties
	drawProperties(paper);
};

function drawAvatar(paper, properties) {
	var avatar = new Avatar (paper, properties);
	avatar.draw();
}

function drawProperties(paper) {
	var thermoOptions = new Options ("thermo", "none", new Array("natural", "cyberware"));
	var thermoWidgetProperties = { 
		x: 170, y:60,  
		valuePaths: {
			"natural": "M16,8.286C8.454,8.286,2.5,16,2.5,16s5.954,7.715,13.5,7.715c5.771,0,13.5-7.715,13.5-7.715S21.771,8.286,16,8.286zM16,20.807c-2.649,0-4.807-2.156-4.807-4.807c0-2.65,2.158-4.807,4.807-4.807c2.648,0,4.807,2.158,4.807,4.807C20.807,18.648,18.648,20.807,16,20.807zM16,13.194c-1.549,0-2.806,1.256-2.806,2.806S14.45,18.807,16,18.807S18.807,17.55,18.807,16C18.807,14.451,17.55,13.194,16,13.194z", 
			"cyberware": "M 16,8.286 C 8.454,8.286 2.5,16 2.5,16 2.5,16 8.454,23.715 16,23.715 21.771,23.715 29.5,16 29.5,16 29.5,16 21.771,8.286 16,8.286 z m 0,12.521 c -2.649,0 -4.807,-2.156 -4.807,-4.807 0,-2.65 2.158,-4.807 4.807,-4.807 2.648,0 4.807,2.158 4.807,4.807 0,2.648 -2.159,4.807 -4.807,4.807 z m 0,-7.613 c -1.549,0 -2.806,1.256 -2.806,2.806 0,1.55 1.256,2.807 2.806,2.807 1.55,0 2.807,-1.257 2.807,-2.807 0,-1.549 -1.257,-2.806 -2.807,-2.806 z m 9.303912,-11.0687023 0,3 -3,0 0,2 3,0 0,3.0000003 2,0 0,-3.0000003 3,0 0,-2 -3,0 0,-3 z"
		}
	 };
	var thermoWidget = new Picker (paper, thermoOptions, thermoWidgetProperties);
	thermoWidget.draw();
	
	var lowlightOptions = new Options ("lowlight", "none", new Array("natural", "cyberware"));
	var lowlightWidgetProperties = { 
		x: 170, y:110,  
		valuePaths: {
			"natural": "M16,8.286C8.454,8.286,2.5,16,2.5,16s5.954,7.715,13.5,7.715c5.771,0,13.5-7.715,13.5-7.715S21.771,8.286,16,8.286zM16,20.807c-2.649,0-4.807-2.156-4.807-4.807c0-2.65,2.158-4.807,4.807-4.807c2.648,0,4.807,2.158,4.807,4.807C20.807,18.648,18.648,20.807,16,20.807zM16,13.194c-1.549,0-2.806,1.256-2.806,2.806S14.45,18.807,16,18.807S18.807,17.55,18.807,16C18.807,14.451,17.55,13.194,16,13.194z", 
			"cyberware": "M 16,8.286 C 8.454,8.286 2.5,16 2.5,16 2.5,16 8.454,23.715 16,23.715 21.771,23.715 29.5,16 29.5,16 29.5,16 21.771,8.286 16,8.286 z m 0,12.521 c -2.649,0 -4.807,-2.156 -4.807,-4.807 0,-2.65 2.158,-4.807 4.807,-4.807 2.648,0 4.807,2.158 4.807,4.807 0,2.648 -2.159,4.807 -4.807,4.807 z m 0,-7.613 c -1.549,0 -2.806,1.256 -2.806,2.806 0,1.55 1.256,2.807 2.806,2.807 1.55,0 2.807,-1.257 2.807,-2.807 0,-1.549 -1.257,-2.806 -2.807,-2.806 z m 9.303912,-11.0687023 0,3 -3,0 0,2 3,0 0,3.0000003 2,0 0,-3.0000003 3,0 0,-2 -3,0 0,-3 z"
		}
	 };
	var lowlightWidget = new Picker (paper, lowlightOptions, lowlightWidgetProperties);
	lowlightWidget.draw();
	
	
	var sightOptions = new Options ("sight", "normal", new Array("partial", "low", "dark", "glare"));
	var sightWidgetProperties = { 
		x: 440, y:60,  
		valuePaths: {
			"partial": "M 13.097,23.463 12.628,23.244 C 9.817,21.938 8,19.094 8,16 c 0,-4.411 3.589,-8 8,-8 1.973,0 3.868,0.729 5.339,2.054 l 0.392,0.353 -5.378,5.378 -3.256,7.678 z m -2.055213,6.764041 -1.8476,-0.7656 2.046832,-4.939558 1.8476,0.7656 z m 9.512564,-22.858643 -1.8476,-0.7656 2.020419,-4.8758163 1.8476,0.7656 z m 3.128033,2.511238 -1.3728,-1.4544 3.428021,-3.2356897 1.3728,1.4544 z M 1.5020584,22.170334 0.73645844,20.322734 5.9309858,18.17025 l 0.7656,1.8476 z m 4.701598,-8.80006 -4.5293913,-1.876869 0.7656,-1.8475998 4.5293913,1.8768688 z M 11.216578,7.4323025 8.8480472,1.7142854 l 1.8477998,-0.7654 2.368531,5.7180171 z M 2,15 6,15 6,17 2,17 z M 6.6565782,25.831241 5.283865,24.377968 7.722223,22.074777 9.0949362,23.52805 z M 7.6686493,9.9217378 5.2984501,7.5515386 l 1.4142,-1.4142 2.3701992,2.3701992 z M 15,3 l 2,0 0,3 -2,0 z", 
			"low": "M 15.941,17 H 8 v -0.5 c 0,-4.897 3.215,-8.188 8,-8.188 2.137,0 3.982,0.646 5.339,1.866 L 21.708,10.511 15.941,17 z m 4.613351,-9.631602 -1.8476,-0.7656 2.020419,-4.8758163 1.8476,0.7656 z m 3.128033,2.511238 -1.3728,-1.4544 3.428021,-3.2356897 1.3728,1.4544 z M 6.2036564,13.370274 1.6742651,11.493405 2.4398651,9.6458052 6.9692564,11.522674 z M 11.216578,7.4323025 8.8480472,1.7142854 l 1.8477998,-0.7654 2.368531,5.7180171 z M 2,15 6,15 6,17 2,17 z M 7.6686493,9.9217378 5.2984501,7.5515386 l 1.4142,-1.4142 2.3701992,2.3701992 z M 15,3 l 2,0 0,3 -2,0 z",
			"dark": "M 15.749,17.218 12.364,9.05 12.847,8.867 C 13.821,8.499 14.882,8.312 16,8.312 c 2.137,0 3.982,0.646 5.339,1.866 l 0.369,0.333 -5.959,6.707 z m 4.805351,-9.849602 -1.8476,-0.7656 2.020419,-4.8758163 1.8476,0.7656 z m 3.128033,2.511238 -1.3728,-1.4544 3.428021,-3.2356897 1.3728,1.4544 z M 11.216578,7.4323025 8.8480472,1.7142854 l 1.8477998,-0.7654 2.368531,5.7180171 z M 15,3 l 2,0 0,3 -2,0 z",
			"glare": "m 15.674,23.793 c -4.411,0 -8,-3.589 -8,-8 0,-4.411 3.588,-8 8,-8 4.412,0 8,3.589 8,8 0,4.411 -3.589,8 -8,8 z m 0,-15 c -3.859,0 -7,3.14 -7,7 0,3.859 3.14,7 7,7 3.86,0 7,-3.141 7,-7 0,-3.86 -3.141,-7 -7,-7 z m 7.5,7 c 0,4.143 -3.357,7.5 -7.5,7.5 -4.142,0 -7.5,-3.357 -7.5,-7.5 0,-4.142 3.358,-7.5 7.5,-7.5 4.142,0 7.5,3.358 7.5,7.5 z m -11.933,8.728 1.848,0.766 -2.047,4.939 -1.848,-0.766 2.047,-4.939 z M 29.902,9.782 30.668,11.63 25.475,13.782 24.709,11.934 29.902,9.782 z M 20.727,1.726 22.575,2.492 20.554,7.368 18.706,6.603 20.727,1.726 z m 4.474,16.858 4.826,1.999 -0.765,1.848 -4.827,-1.999 0.766,-1.848 z m -5.012,5.937 1.988,4.799 -1.848,0.766 -1.988,-4.799 1.848,-0.766 z M 25,15 h 3 v 2 H 25 V 15 z M 25.736,5.189 27.109,6.644 23.682,9.88 22.309,8.426 25.736,5.189 z m -2,16.844 2.369,2.371 -1.414,1.414 -2.369,-2.371 1.414,-1.414 z M 14,26 h 2 v 3 H 14 V 26 z M 5.931,18.17 6.697,20.018 1.502,22.17 0.736,20.322 5.931,18.17 z M 2.44,9.646 6.969,11.523 6.204,13.37 1.675,11.493 2.44,9.646 z M 10.696,0.949 13.064,6.667 11.216,7.433 8.848,1.714 10.696,0.949 z M 2,15 h 4 v 2 H 2 v -2 z m 5.722,7.075 1.373,1.453 -2.438,2.304 -1.373,-1.453 2.438,-2.304 z M 6.713,6.137 9.083,8.507 7.669,9.921 5.298,7.551 6.713,6.137 z M 15,3 h 2 V 6 H 15 V 3 z",
		}
	 };
	var sightWidget = new Picker (paper, sightOptions, sightWidgetProperties);
	sightWidget.draw();
	
	
	
}

function drawPropertiesColumn(paper, properties, widgets2) {
	var columnProperties = {
		"x": 180,
		"y": 60,
		"boxAlign": left,
		"textAlign": left,
		"titleOffset": 5,
		"widgetOffset": 20,
		"fontColor": "#ccc",
		"fontStyle": undefined
	};
	
	var thermoWidget = new Widget (paper, {"title": "Thermovision"}, new Picker (paper, properties) );
	var lowLight = new Picker (paper, properties);
	var blind = new Picker(paper, properties);
	var smartgun = new Picker(paper, properties);
	var recoilCompensation = new Picker(paper, properties);
	var gyro = new Picker(paper, properties);
	var secondFirearm = new Picker(paper, properties);
	
	var widgets = {0:thermo, 1: lowLight, 2: blind, 3: smartgun, 4: recoilCompensation, 5:gyro, 6:secondFirearm};

	drawPropertiesColumn (paper, columnProperties, widgets);
	
	

	var numberOfWidgets = widgets.length;
	alert(widgets.length);
}

function drawTitledWidget (paper, properties, widget) {
	var w = new Widget(paper, properties, widget);
	w.draw;
}